<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CollageMaster Pro - Create Beautiful Photo Collages Online</title>
    <meta name="description" content="Free online photo collage maker. Combine multiple photos into beautiful collages with professional templates and customization options.">
    <meta name="keywords" content="photo collage maker, collage creator, combine photos, photo grid, collage templates, image collage">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-dark: #0a192f;
            --secondary-dark: #112240;
            --accent-blue: #64ffda;
            --accent-purple: #7b4fff;
            --text-primary: #e6f1ff;
            --text-secondary: #8892b0;
            --card-bg: #172a45;
            --slider-bg: #2d3f5a;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #0d1b2a 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(10, 25, 47, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        header {
            background: linear-gradient(to right, var(--secondary-dark), var(--primary-dark));
            color: var(--text-primary);
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            color: var(--text-secondary);
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
            gap: 20px;
        }
        
        .tool-section {
            flex: 1 1 700px;
            padding: 25px;
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .ad-section {
            flex: 0 1 300px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .ad-unit {
            background: var(--secondary-dark);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(100, 255, 218, 0.2);
            overflow: hidden;
        }
        
        .ad-unit.horizontal {
            min-height: 90px;
            width: 100%;
        }
        
        .ad-unit.vertical {
            min-height: 250px;
            width: 100%;
        }
        
        .ad-unit.square {
            min-height: 250px;
            width: 100%;
        }
        
        .upload-container {
            border: 2px dashed var(--accent-purple);
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s;
            background: rgba(27, 42, 65, 0.5);
        }
        
        .upload-container:hover {
            background: rgba(39, 59, 89, 0.5);
            border-color: var(--accent-blue);
        }
        
        .upload-container i {
            font-size: 3rem;
            color: var(--accent-blue);
            margin-bottom: 15px;
        }
        
        .upload-btn {
            background: linear-gradient(45deg, var(--accent-purple), var(--accent-blue));
            color: var(--primary-dark);
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(123, 79, 255, 0.4);
        }
        
        .collage-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--accent-blue);
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 5px;
            background: var(--slider-bg);
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-blue);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-blue);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
            border: none;
        }
        
        .value-display {
            font-weight: 700;
            color: var(--accent-blue);
            min-width: 40px;
        }
        
        select, input[type="color"] {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid var(--slider-bg);
            background: var(--secondary-dark);
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background: var(--secondary-dark);
            border-radius: 10px;
        }
        
        .template {
            aspect-ratio: 1;
            border: 2px solid var(--accent-purple);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: grid;
            overflow: hidden;
        }
        
        .template:hover {
            transform: scale(1.05);
            border-color: var(--accent-blue);
        }
        
        .template.active {
            border-color: var(--accent-blue);
            box-shadow: 0 0 15px rgba(100, 255, 218, 0.5);
        }
        
        .template-2 {
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }
        
        .template-3 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        
        .template-4 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        
        .template-5 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }
        
        .template-cell {
            background: rgba(100, 255, 218, 0.2);
            border: 1px solid var(--accent-blue);
        }
        
        .preview-container {
            margin: 30px 0;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--secondary-dark);
            border-radius: 10px;
            padding: 20px;
        }
        
        #collageCanvas {
            max-width: 100%;
            max-height: 400px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(100, 255, 218, 0.2);
        }
        
        .preview-placeholder {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
        
        .uploaded-images {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: var(--secondary-dark);
            border-radius: 10px;
            min-height: 100px;
        }
        
        .image-thumbnail {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 5px;
            border: 2px solid var(--accent-purple);
            cursor: move;
        }
        
        .image-thumbnail:hover {
            border-color: var(--accent-blue);
            transform: scale(1.05);
        }
        
        .file-info {
            background: var(--secondary-dark);
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--accent-purple), var(--accent-blue));
            color: var(--primary-dark);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(123, 79, 255, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--accent-blue);
            border: 2px solid var(--accent-blue);
        }
        
        .btn-outline:hover {
            background: rgba(100, 255, 218, 0.1);
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            background: var(--secondary-dark);
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .seo-content {
            padding: 30px;
            background: var(--card-bg);
            margin: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .seo-content h2 {
            color: var(--accent-blue);
            margin-bottom: 20px;
        }
        
        .seo-content p {
            margin-bottom: 15px;
            color: var(--text-secondary);
        }
        
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--accent-blue);
            color: var(--accent-blue);
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .ad-section {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .ad-unit {
                flex: 1 1 200px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            header p {
                font-size: 1rem;
            }
            
            .theme-toggle {
                position: relative;
                top: 0;
                right: 0;
                margin: 0 auto 20px;
                width: fit-content;
            }
            
            .collage-controls {
                grid-template-columns: 1fr;
            }
            
            .template-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .action-buttons {
                flex-direction: column;
            }
            
            .upload-container {
                padding: 20px 10px;
            }
            
            .image-thumbnail {
                width: 60px;
                height: 60px;
            }
        }
        
        /* Animation for processing */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .processing {
            animation: pulse 1.5s infinite;
        }
        
        /* Stats display */
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            background: var(--secondary-dark);
            padding: 15px;
            border-radius: 10px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
            min-width: 120px;
            margin: 5px;
            display: none;
        }
        
        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-blue);
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        /* Drag and drop styles */
        .drag-over {
            background: rgba(100, 255, 218, 0.3) !important;
            border-color: var(--accent-blue) !important;
        }
    </style>
</head>
<body>
    <button class="theme-toggle">
        <i class="fas fa-moon"></i> Dark Mode
    </button>

    <div class="container">
        <!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Navbar Start -->
<nav class="w-full bg-[#0b1526] px-6 py-4 flex items-center justify-between shadow-md">
  <!-- Logo -->
  <a href="/Tool/index.html" class="flex items-center space-x-2">
    <div class="w-6 h-6 bg-gradient-to-r from-green-400 to-teal-500 rounded-full"></div>
    <span class="text-xl font-bold text-teal-300">ToolKit</span>
  </a>

  <!-- Desktop Menu -->
  <ul class="hidden md:flex space-x-8 font-medium text-white">
    <li><a href="/Tool/index.html" class="hover:text-teal-400 transition">Home</a></li>
    <li><a href="/Tool/about.html" class="hover:text-teal-400 transition">About</a></li>
    <li><a href="/Tool/contect.html" class="hover:text-teal-400 transition">Contact Us</a></li>
    <li><a href="/Tool/privacy.html" class="hover:text-teal-400 transition">Privacy Policy</a></li>
    <li><a href="/Tool/term.html" class="hover:text-teal-400 transition">Terms & Conditions</a></li>
    <li><a href="/Tool/desclaimar.html" class="hover:text-teal-400 transition">Disclaimer</a></li>
  </ul>

  <!-- Buttons (Desktop) -->
  <div class="hidden md:flex space-x-4">
    <button class="px-4 py-2 rounded-lg bg-gradient-to-r from-green-400 to-teal-500 text-sm font-semibold text-white shadow-md hover:opacity-90 transition">Login</button>
    <button class="px-4 py-2 rounded-lg bg-gradient-to-r from-purple-400 to-blue-500 text-sm font-semibold text-white shadow-md hover:opacity-90 transition">Sign Up</button>
  </div>

  <!-- Mobile Hamburger -->
  <div class="md:hidden">
    <button id="menu-btn" class="focus:outline-none">
      <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" stroke-width="2"
           viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
    </button>
  </div>
</nav>

<!-- Mobile Menu -->
<div id="menu" class="hidden md:hidden flex flex-col bg-[#0b1526] px-6 py-4 space-y-4 text-white transition-all duration-300 ease-in-out">
  <a href="/Tool/index.html" class="block hover:text-teal-400 transition">Home</a>
  <a href="/Tool/about.html" class="block hover:text-teal-400 transition">About</a>
  <a href="/Tool/contect.html" class="block hover:text-teal-400 transition">Contact Us</a>
  <a href="/Tool/privacy.html" class="block hover:text-teal-400 transition">Privacy Policy</a>
  <a href="/Tool/term.html" class="block hover:text-teal-400 transition">Terms & Conditions</a>
  <a href="/Tool/desclaimar.html" class="block hover:text-teal-400 transition">Disclaimer</a>
  
  <button class="w-full px-4 py-2 rounded-lg bg-gradient-to-r from-green-400 to-teal-500 text-sm font-semibold text-white shadow-md hover:opacity-90 transition">Login</button>
  <button class="w-full px-4 py-2 rounded-lg bg-gradient-to-r from-purple-400 to-blue-500 text-sm font-semibold text-white shadow-md hover:opacity-90 transition">Sign Up</button>
</div>
<!-- Navbar End -->

 <div class="ad-unit horizontal">
                    <!-- Adsterra Leaderboard Banner -->
                    <script type="text/javascript">
                        atOptions = {
                            'key' : 'dfb13df8c68bb9b06c88d4a4fde08313',
                            'format' : 'iframe',
                            'height' : 90,
                            'width' : 728,
                            'params' : {}
                        };
                    </script>
                    <script type="text/javascript" src="//www.highperformanceformat.com/dfb13df8c68bb9b06c88d4a4fde08313/invoke.js"></script>
                </div>
                
<!-- Script -->
<script>
  const btn = document.getElementById('menu-btn');
  const menu = document.getElementById('menu');

  btn.addEventListener('click', () => {
    menu.classList.toggle('hidden');
  });
</script>

        <header>
            <h1>CollageMaster Pro</h1>
            <p>Create beautiful photo collages with professional templates</p>
        </header>
        
        <div class="main-content">
            <section class="tool-section">
                <div class="upload-container" id="dropZone">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h2>Upload Your Photos</h2>
                    <p>Drag & drop images or click to select (2-6 images recommended)</p>
                    <input type="file" id="imageUpload" accept="image/*" multiple hidden>
                    <button class="upload-btn" id="uploadTrigger"><i class="fas fa-upload"></i> Select Photos</button>
                </div>
                
                <div class="uploaded-images" id="imageGallery">
                    <div class="preview-placeholder">Your photos will appear here</div>
                </div>
                
                <h3>Choose a Template</h3>
                <div class="template-grid">
                    <div class="template template-2 active" data-cells="1">
                        <div class="template-cell"></div>
                    </div>
                    <div class="template template-3" data-cells="2">
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                    </div>
                    <div class="template template-4" data-cells="4">
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                    </div>
                    <div class="template template-5" data-cells="6">
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                        <div class="template-cell"></div>
                    </div>
                </div>
                
                <div class="collage-controls">
                    <div class="control-group">
                        <label for="collageStyle">Collage Style</label>
                        <select id="collageStyle">
                            <option value="grid">Grid</option>
                            <option value="masonry">Masonry</option>
                            <option value="freeform">Freeform</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="spacing">Spacing</label>
                        <div class="slider-container">
                            <input type="range" id="spacing" min="0" max="30" value="5">
                            <span class="value-display" id="spacingValue">5px</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label for="borderWidth">Border Width</label>
                        <div class="slider-container">
                            <input type="range" id="borderWidth" min="0" max="10" value="2">
                            <span class="value-display" id="borderWidthValue">2px</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label for="borderColor">Border Color</label>
                        <input type="color" id="borderColor" value="#ffffff">
                    </div>
                    
                    <div class="control-group">
                        <label for="compressionLevel">Compression Level</label>
                        <div class="slider-container">
                            <input type="range" id="compressionLevel" min="0" max="100" value="80">
                            <span class="value-display" id="compressionValue">80%</span>
                        </div>
                    </div>
                </div>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="originalSizeStat">0 KB</div>
                        <div class="stat-label">Original Size</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="compressedSizeStat">0 KB</div>
                        <div class="stat-label">Compressed Size</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="savingsStat">0%</div>
                        <div class="stat-label">Size Reduction</div>
                    </div>
                </div>
                
                <div class="preview-container">
                    <div class="preview-placeholder" id="previewPlaceholder">Your collage will appear here</div>
                    <canvas id="collageCanvas"></canvas>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="generateBtn" disabled><i class="fas fa-magic"></i> Generate Collage</button>
                    <button class="btn btn-outline" id="downloadBtn" disabled><i class="fas fa-download"></i> Download</button>
                    <button class="btn btn-outline" id="resetBtn"><i class="fas fa-redo"></i> Reset</button>
                </div>
            </section>
            
            <section class="ad-section">
                <div class="ad-unit horizontal">
                    <!-- Adsterra Leaderboard Banner -->
                    <script type="text/javascript">
                        atOptions = {
                            'key' : 'dfb13df8c68bb9b06c88d4a4fde08313',
                            'format' : 'iframe',
                            'height' : 90,
                            'width' : 728,
                            'params' : {}
                        };
                    </script>
                    <script type="text/javascript" src="//www.highperformanceformat.com/dfb13df8c68bb9b06c88d4a4fde08313/invoke.js"></script>
                </div>
                
                <div class="ad-unit vertical">
                    <!-- Adsterra Native Banner (Vertical) -->
                    <script async="async" data-cfasync="false" src="//pl27598289.revenuecpmgate.com/66ab86a52b5de6c71875567f09387ce0/invoke.js"></script>
                    <div id="container-66ab86a52b5de6c71875567f09387ce0"></div>
                </div>
                
                <div class="ad-unit square">
                    <!-- Adsterra Native Banner (Square) -->
                    <script async="async" data-cfasync="false" src="//pl27598289.revenuecpmgate.com/66ab86a52b5de6c71875567f09387ce0/invoke.js"></script>
                    <div id="container-66ab86a52b5de6c71875567f09387ce0"></div>
                </div>
            </section>
        </div>
        
        <section class="seo-content">
            <h2>Create Stunning Photo Collages Online</h2>
            <p>CollageMaster Pro is the ultimate online tool for creating beautiful photo collages from your images. Whether you want to combine family photos, create a social media post, or make a memory board, our tool provides professional-grade collage creation with customizable templates.</p>
            
            <p>With multiple layout options, adjustable spacing, border customization, and compression features, you can create perfect collages for any purpose. Our intuitive interface makes it easy to arrange your photos exactly how you want them.</p>
            
            <p>All processing happens directly in your browser for maximum privacy and speed. No registration required - just upload, create, and download your collage instantly!</p>
        </section>
        
        <footer>
            <p>&copy; 2023 CollageMaster Pro | All Rights Reserved</p>
            <p>This tool processes your images entirely in your browser - no uploads to servers required!</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const uploadTrigger = document.getElementById('uploadTrigger');
            const imageUpload = document.getElementById('imageUpload');
            const generateBtn = document.getElementById('generateBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const resetBtn = document.getElementById('resetBtn');
            const imageGallery = document.getElementById('imageGallery');
            const previewPlaceholder = document.getElementById('previewPlaceholder');
            const canvas = document.getElementById('collageCanvas');
            const ctx = canvas.getContext('2d');
            const dropZone = document.getElementById('dropZone');
            
            // Controls
            const spacing = document.getElementById('spacing');
            const spacingValue = document.getElementById('spacingValue');
            const borderWidth = document.getElementById('borderWidth');
            const borderWidthValue = document.getElementById('borderWidthValue');
            const borderColor = document.getElementById('borderColor');
            const compressionLevel = document.getElementById('compressionLevel');
            const compressionValue = document.getElementById('compressionValue');
            const collageStyle = document.getElementById('collageStyle');
            
            // Stats
            const originalSizeStat = document.getElementById('originalSizeStat');
            const compressedSizeStat = document.getElementById('compressedSizeStat');
            const savingsStat = document.getElementById('savingsStat');
            
            let uploadedImages = [];
            let collageImageBlob = null;
            let totalOriginalSize = 0;
            let selectedTemplate = '2';
            
            // Event listeners
            uploadTrigger.addEventListener('click', () => imageUpload.click());
            
            imageUpload.addEventListener('change', function(e) {
                if (this.files && this.files.length > 0) {
                    handleFiles(this.files);
                }
            });
            
            // Template selection
            document.querySelectorAll('.template').forEach(template => {
                template.addEventListener('click', function() {
                    document.querySelectorAll('.template').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    selectedTemplate = this.getAttribute('data-cells');
                    if (uploadedImages.length > 0) generateCollage();
                });
            });
            
            // Control event listeners
            spacing.addEventListener('input', function() {
                spacingValue.textContent = `${this.value}px`;
                if (uploadedImages.length > 0) generateCollage();
            });
            
            borderWidth.addEventListener('input', function() {
                borderWidthValue.textContent = `${this.value}px`;
                if (uploadedImages.length > 0) generateCollage();
            });
            
            borderColor.addEventListener('input', function() {
                if (uploadedImages.length > 0) generateCollage();
            });
            
            collageStyle.addEventListener('change', function() {
                if (uploadedImages.length > 0) generateCollage();
            });
            
            compressionLevel.addEventListener('input', function() {
                compressionValue.textContent = `${this.value}%`;
            });
            
            // Drag and drop functionality
            dropZone.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });
            
            dropZone.addEventListener('dragleave', function() {
                this.classList.remove('drag-over');
            });
            
            dropZone.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                if (e.dataTransfer.files.length > 0) {
                    handleFiles(e.dataTransfer.files);
                }
            });
            
            generateBtn.addEventListener('click', function() {
                if (uploadedImages.length === 0) {
                    alert('Please upload at least one image first.');
                    return;
                }
                
                processCollage();
            });
            
            downloadBtn.addEventListener('click', function() {
                if (!collageImageBlob) return;
                
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(collageImageBlob);
                downloadLink.download = 'photo-collage.jpg';
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
            });
            
            resetBtn.addEventListener('click', function() {
                // Reset everything
                uploadedImages = [];
                collageImageBlob = null;
                totalOriginalSize = 0;
                imageGallery.innerHTML = '<div class="preview-placeholder">Your photos will appear here</div>';
                previewPlaceholder.style.display = 'block';
                canvas.style.display = 'none';
                imageUpload.value = '';
                
                // Reset controls
                spacing.value = 5;
                spacingValue.textContent = '5px';
                borderWidth.value = 2;
                borderWidthValue.textContent = '2px';
                borderColor.value = '#ffffff';
                compressionLevel.value = 80;
                compressionValue.textContent = '80%';
                collageStyle.value = 'grid';
                
                // Reset templates
                document.querySelectorAll('.template').forEach(t => t.classList.remove('active'));
                document.querySelector('.template-2').classList.add('active');
                selectedTemplate = '2';
                
                generateBtn.disabled = true;
                downloadBtn.disabled = true;
                
                // Reset stats
                document.querySelectorAll('.stat-item').forEach(item => {
                    item.style.display = 'none';
                });
            });
            
            function handleFiles(files) {
                const imageFiles = Array.from(files).filter(file => file.type.match('image.*'));
                
                if (imageFiles.length === 0) {
                    alert('Please select valid image files.');
                    return;
                }
                
                // Clear placeholder
                if (imageGallery.querySelector('.preview-placeholder')) {
                    imageGallery.innerHTML = '';
                }
                
                // Process each image
                imageFiles.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = new Image();
                        img.onload = function() {
                            // Create thumbnail
                            const thumbnail = document.createElement('img');
                            thumbnail.src = e.target.result;
                            thumbnail.className = 'image-thumbnail';
                            thumbnail.title = file.name;
                            imageGallery.appendChild(thumbnail);
                            
                            // Store image data
                            uploadedImages.push({
                                element: img,
                                src: e.target.result,
                                width: img.width,
                                height: img.height,
                                name: file.name,
                                size: file.size
                            });
                            
                            // Update total size
                            totalOriginalSize += file.size;
                            const totalSizeKB = (totalOriginalSize / 1024).toFixed(2);
                            originalSizeStat.textContent = `${totalSizeKB} KB`;
                            document.querySelectorAll('.stat-item').forEach(item => {
                                item.style.display = 'block';
                            });
                            
                            // Enable generate button if we have at least one image
                            if (uploadedImages.length > 0) {
                                generateBtn.disabled = false;
                            }
                            
                            // Auto-generate collage if we have images
                            if (uploadedImages.length > 0) {
                                generateCollage();
                            }
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
            }
            
            function generateCollage() {
                if (uploadedImages.length === 0) return;
                
                // Hide placeholder
                previewPlaceholder.style.display = 'none';
                canvas.style.display = 'block';
                
                // Determine collage dimensions based on template
                const cellCount = parseInt(selectedTemplate);
                const effectiveImageCount = Math.min(uploadedImages.length, cellCount);
                
                // Set canvas size
                const spacingValue = parseInt(spacing.value);
                const borderWidthValue = parseInt(borderWidth.value);
                
                canvas.width = 800;
                canvas.height = 600;
                
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw background
                ctx.fillStyle = '#1a1a1a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw collage based on selected template
                if (collageStyle.value === 'grid') {
                    drawGridCollage(effectiveImageCount, spacingValue, borderWidthValue);
                } else {
                    // For simplicity, we'll just use grid for all styles in this demo
                    drawGridCollage(effectiveImageCount, spacingValue, borderWidthValue);
                }
            }
            
            function drawGridCollage(imageCount, spacing, borderWidth) {
                const cols = imageCount <= 2 ? imageCount : Math.ceil(Math.sqrt(imageCount));
                const rows = Math.ceil(imageCount / cols);
                
                const cellWidth = (canvas.width - (spacing * (cols + 1))) / cols;
                const cellHeight = (canvas.height - (spacing * (rows + 1))) / rows;
                
                for (let i = 0; i < imageCount; i++) {
                    const col = i % cols;
                    const row = Math.floor(i / cols);
                    
                    const x = spacing + (col * (cellWidth + spacing));
                    const y = spacing + (row * (cellHeight + spacing));
                    
                    // Draw image
                    const img = uploadedImages[i].element;
                    const ratio = Math.min(cellWidth / img.width, cellHeight / img.height);
                    const drawWidth = img.width * ratio;
                    const drawHeight = img.height * ratio;
                    const offsetX = (cellWidth - drawWidth) / 2;
                    const offsetY = (cellHeight - drawHeight) / 2;
                    
                    ctx.drawImage(img, x + offsetX, y + offsetY, drawWidth, drawHeight);
                    
                    // Draw border
                    if (borderWidth > 0) {
                        ctx.strokeStyle = borderColor.value;
                        ctx.lineWidth = borderWidth;
                        ctx.strokeRect(x, y, cellWidth, cellHeight);
                    }
                }
            }
            
            function processCollage() {
                if (uploadedImages.length === 0) return;
                
                // Show processing state
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                generateBtn.classList.add('processing');
                
                // Simulate processing time
                setTimeout(() => {
                    // Get compression level
                    const quality = compressionLevel.value / 100;
                    
                    // Convert canvas to blob with compression
                    canvas.toBlob(function(blob) {
                        collageImageBlob = blob;
                        
                        // Update file info
                        const collageSize = blob.size;
                        const collageSizeKB = (collageSize / 1024).toFixed(2);
                        compressedSizeStat.textContent = `${collageSizeKB} KB`;
                        
                        // Calculate savings
                        const savings = (100 - (collageSize / totalOriginalSize) * 100).toFixed(1);
                        savingsStat.textContent = `${savings}%`;
                        
                        // Enable download button
                        downloadBtn.disabled = false;
                        
                        // Reset generate button
                        generateBtn.disabled = false;
                        generateBtn.innerHTML = '<i class="fas fa-magic"></i> Generate Collage';
                        generateBtn.classList.remove('processing');
                    }, 'image/jpeg', quality);
                }, 1000);
            }
            
            // Theme toggle functionality
            const themeToggle = document.querySelector('.theme-toggle');
            themeToggle.addEventListener('click', function() {
                const icon = this.querySelector('i');
                if (icon.classList.contains('fa-moon')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                    this.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                    document.body.style.filter = 'invert(1) hue-rotate(180deg)';
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                    this.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                    document.body.style.filter = 'none';
                }
            });
        });
    </script>
</body>
</html>
